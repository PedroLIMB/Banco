<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Banco DIP</title>
  <link rel="shortcut icon" type="image/png" href="/Imagens/LOGO DIP.ico">
  <link rel="stylesheet" href="/css/dip.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css" integrity="sha512-10/jx2EXwxxWqCLX/hHth/vu2KY3jCF70dCQB8TSgNjbCVAC/8vai53GfMDrO2Emgwccf2pJqxct9ehpzG+MTw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>

<header class="header">
  <div class="container">
    <div class="logo">
      <a href="dip.html">
      <img src="/Imagens/LOGO DIP.png" alt="Logo Banco DIP">
      Banco DIP
      </a>
    </div>
    <nav>
      <ul class="nav-links">
        <li><a href="#">Sobre</a></li>
        <li><a href="#">Serviços</a></li>
        <li><a href="#">Contato</a></li>
        <li><a href="#">Ajuda</a></li>
        <li><a href="login.html">Login</a></li>
      </ul>
      <div class="menu-br">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </div>
    </nav>
  </div>
</header>

<main class="main">
  <div class="container">
    <div class="content">
      <h1>Bem-vindo ao Banco DIP</h1>
      <p>Gerencie sua vida financeira de forma simples e eficiente.</p>
      <div class="transacao">
        <label for="valorTransacao">Digite o Valor da Transação:</label>
        <input type="number" id="valorTransacao" placeholder="Digite o valor...">
        <label for="emailDestinatario">Email do Destinatário (para Transferência):</label>
        <input type="email" id="emailDestinatario" placeholder="Digite o email do destinatário...">
        <div class="botoes-transacao">
          <button id="botaoDeposito">Depósito</button>
          <button id="botaoSaque">Saque</button>
          <button id="botaoTransferencia">Transferência</button>
        </div>
      </div>
      <div class="saldo">
        <h2>Seu Saldo: <span id="saldo">R$ 0.00</span></h2>
      </div>
      <div class="limiteChequeEspecial">
        <h3>Limite de Cheque Especial</h3>
        <p>Máximo: <span id="limiteChequeEspecial">R$ 0.00</span></p>
      </div>
      <div id="resultado"></div>
    </div>
  </div>
</main>

<footer>
  <img src="/Imagens/LOGO DIP.png" alt="Logo Banco DIP">
  <p>2024 Banco DIP</p>
</footer>

<!-- Seção do JavaScript -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script>
  // Your web app's Firebase configuration
const firebaseConfig = {
apiKey: "AIzaSyDOqHiQ8tnsIflSOrjWZGawDN4Iock2g0s",
authDomain: "bancodip-61293.firebaseapp.com",
databaseURL: "https://bancodip-61293-default-rtdb.firebaseio.com",
projectId: "bancodip-61293",
storageBucket: "bancodip-61293.appspot.com",
messagingSenderId: "550802117666",
appId: "1:550802117666:web:1d5a25c1ebf621fe95667b",
measurementId: "G-RGV9JTDSGL"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);

// Referência ao Firestore
const db = firebase.firestore();

// Verificar se o usuário está autenticado
firebase.auth().onAuthStateChanged(function(user) {
  if (user) {
    // Usuário está autenticado
    const userId = user.uid;

    // Função para realizar o depósito
    document.getElementById("botaoDeposito").addEventListener("click", () => {
      const valorTransacao = parseFloat(document.getElementById("valorTransacao").value);
      const saldoAtual = parseFloat(document.getElementById("saldo").textContent.replace("R$ ", ""));

      const novoSaldo = saldoAtual + valorTransacao;

      // Atualizar o saldo no Firestore
      db.collection("users").doc(userId)
        .update({
          saldo: novoSaldo
        })
        .then(() => {
          document.getElementById("saldo").textContent = `R$ ${novoSaldo.toFixed(2)}`;
          document.getElementById("resultado").textContent = "Depósito realizado com sucesso!";
        })
        .catch((error) => {
          console.error("Erro ao realizar depósito:", error);
          document.getElementById("resultado").textContent = "Erro ao realizar depósito. Por favor, tente novamente.";
        });
    });

    // Função para realizar o saque
    document.getElementById("botaoSaque").addEventListener("click", () => {
      const valorTransacao = parseFloat(document.getElementById("valorTransacao").value);
      const saldoAtual = parseFloat(document.getElementById("saldo").textContent.replace("R$ ", ""));

      // Verificar se há saldo suficiente para o saque
      if (valorTransacao > saldoAtual) {
        document.getElementById("resultado").textContent = "Saldo insuficiente para realizar o saque.";
        return;
      }

      const novoSaldo = saldoAtual - valorTransacao;

      // Atualizar o saldo no Firestore
      db.collection("users").doc(userId)
        .update({
          saldo: novoSaldo
        })
        .then(() => {
          document.getElementById("saldo").textContent = `R$ ${novoSaldo.toFixed(2)}`;
          document.getElementById("resultado").textContent = "Saque realizado com sucesso!";
        })
        .catch((error) => {
          console.error("Erro ao realizar saque:", error);
          document.getElementById("resultado").textContent = "Erro ao realizar saque. Por favor, tente novamente.";
        });
    });
  }
});

</script>
</body>
</html>

